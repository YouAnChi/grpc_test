# gRPC 聊天应用

这是一个基于 gRPC 的简单聊天应用，支持用户注册、登录和实时聊天功能。

## 项目架构

### 目录结构
```
.
├── proto/           # Protocol Buffers 定义文件
│   └── chat.proto   # 聊天服务接口定义
├── server/          # 服务端实现
│   └── server.go    # 服务端代码
├── client/          # 客户端实现
│   └── client.go    # 客户端代码
└── grpc_chat/       # 生成的 gRPC 代码
    └── proto/       # 编译后的 Protocol Buffers 代码
```

### 核心功能

1. **用户管理**
   - 用户注册：新用户可以注册账号
   - 用户登录：已注册用户可以登录系统

2. **聊天功能**
   - 实时消息：支持用户之间的实时消息交换
   - 系统通知：显示用户加入聊天室的系统消息
   - 时间戳：每条消息都带有发送时间

3. **通信机制**
   - 使用 gRPC 双向流式通信
   - 支持多客户端同时连接
   - 消息广播机制

## 使用流程

### 启动服务器

1. 进入项目目录：
   ```bash
   cd grpc_test
   ```

2. 启动服务器：
   ```bash
   go run server/server.go
   ```
   服务器将在 50051 端口启动

### 启动客户端

1. 在新的终端窗口中启动客户端：
   ```bash
   go run client/client.go
   ```

2. 客户端操作流程：
   - 选择 "1" 进行用户注册
   - 选择 "2" 进行用户登录
   - 选择 "3" 进入聊天室
   - 在聊天室中输入消息并按回车发送
   - 输入 "/quit" 退出聊天室
   - 选择 "4" 退出程序

## 测试指南

### 功能测试

1. **注册测试**
   - 测试注册新用户
   - 测试重复用户名注册

2. **登录测试**
   - 测试正确的用户名和密码
   - 测试错误的用户名或密码

3. **聊天测试**
   - 打开多个终端，运行多个客户端
   - 使用不同账号登录
   - 测试消息发送和接收
   - 测试用户加入提醒
   - 测试用户退出

### 测试步骤示例

1. **多用户聊天测试**
   ```bash
   # 终端 1
   go run client/client.go
   # 注册并登录用户1
   
   # 终端 2
   go run client/client.go
   # 注册并登录用户2
   
   # 两个用户进入聊天室后互相发送消息
   ```

2. **错误处理测试**
   - 测试服务器未启动时的客户端行为
   - 测试未登录直接进入聊天室
   - 测试网络断开时的行为

## 部署注意事项

1. **环境要求**
   - Go 1.16 或更高版本
   - 正确设置 GOPATH 和 GOROOT
   - 安装必要的依赖：
     ```bash
     go mod tidy
     ```

2. **网络配置**
   - 确保 50051 端口可用
   - 如需跨网络部署，修改客户端连接地址
   - 考虑添加 TLS 加密（当前版本使用不安全连接）

3. **性能考虑**
   - 监控内存使用情况
   - 注意并发连接数限制
   - 考虑添加消息队列机制

4. **安全建议**
   - 实现真实的用户认证机制
   - 添加密码加密存储
   - 实现真实的 token 生成和验证
   - 添加消息内容验证

## 扩展建议
123
1. **功能扩展**
   - 添加私聊功能
   - 实现消息历史记录
   - 添加文件传输功能
   - 实现用户在线状态

2. **性能优化**
   - 添加消息缓存
   - 实现消息压缩
   - 优化并发处理

3. **安全增强**
   - 添加 TLS 加密
   - 实现完整的认证机制
   - 添加消息加密